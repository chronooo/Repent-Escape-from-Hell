------- FILE animation_test.s LEVEL 1 PASS 2
      1  112b					      processor	6502
      2  112c ????
      3  112c ????						;   KERNAL [sic] routines
      4  112c ????	       32 33 34 35 IDLE_TOP_1 =	"12345"
      5  112c ????	       32 33 34 35 IDLE_TOP_2 =	"12345"
      6  112c ????	       32 33 34 35 LEFT_TOP_1 =	"12345"
      7  112c ????	       32 33 34 35 LEFT_TOP_2 =	"12345"
      8  112c ????	       32 33 34 35 RIGHT_TOP_1 =	"12345"
      9  112c ????	       32 33 34 35 RIGHT_TOP_2 =	"12345"
     10  112c ????						;   zero PAGE USage
     11  112c ????						;   20:current status(idle/left/right + frame/1/2)
     12  112c ????						; idle frame 1/2: 0/1
     13  112c ????						; left frame 1/2: 2/3
     14  112c ????						; right frame 1/2: 4/5
     15  112c ????						;   21: x movement
     16  112c ????						;   22: y movement
     17  1001					      org	$1001
     18  1001		       0b 10		      dc.w	stubend
     19  1003		       39 30		      dc.w	12345
     20  1005		       9e 34 31 30*	      dc.b	$9e, "4109", 0
     21  100b				   stubend
     22  100b		       00 00		      dc.w	0
     23  100d
     24  100d				   main
     25  100d		       20 0f 11 	      jsr	store_char
     26  1010		       20 d1 10 	      jsr	clear_screen
     27  1013
     28  1013							;charcterset to from 1c00
     29  1013		       a9 ff		      lda	#255
     30  1015		       8d 05 90 	      sta	$9005
     31  1018
     32  1018							;start location
     33  1018		       a9 01		      lda	#1
     34  101a		       85 21		      sta	$21
     35  101c		       a9 01		      lda	#1
     36  101e		       85 22		      sta	$22
     37  1020
     38  1020				   main_loop
     39  1020		       20 8a 10 	      jsr	shift_on_monitor
     40  1023		       a9 00		      lda	#$0
     41  1025		       a0 00		      ldy	#$0
     42  1027		       91 02		      sta	($02),y
     43  1029		       91 04		      sta	($04),y
     44  102b
     45  102b							;jmp	  s_down       ;test purpose
     46  102b		       a5 c5		      lda	$00C5	; loads the current pressed key from memory
     47  102d
     48  102d		       c9 40		      cmp	#64	;if nothing held down
     49  102f		       f0 16		      beq	case_idle
     50  1031		       c9 11		      cmp	#17	; if A is pressed
     51  1033		       f0 15		      beq	a_left
     52  1035		       c9 12		      cmp	#18	; if D is pressed
     53  1037		       f0 1c		      beq	d_right
     54  1039		       c9 09		      cmp	#9	;if W is pressed
     55  103b		       f0 23		      beq	w_top
     56  103d		       c9 29		      cmp	#41	;if S is pressed
     57  103f		       f0 2a		      beq	s_down
     58  1041		       c9 21		      cmp	#33
     59  1043		       f0 44		      beq	exit_prg
     60  1045				   main_update_shift
     61  1045		       a5 20		      lda	$20
     62  1047				   case_idle
     63  1047							;coordinate not updated
     64  1047		       4c 76 10 	      jmp	main_update_shift_end
     65  104a				   a_left
     66  104a							;check if x<1
     67  104a		       a5 21		      lda	$21
     68  104c		       c9 01		      cmp	#1
     69  104e		       90 f7		      bcc	case_idle	;tooleft,cannotmove
     70  1050		       c6 21		      dec	$21
     71  1052		       4c 76 10 	      jmp	main_update_shift_end
     72  1055				   d_right
     73  1055							;check if x> 20 => 20< X (21 is maximum)
     74  1055		       a9 14		      lda	#20
     75  1057		       c5 21		      cmp	$21
     76  1059		       90 ec		      bcc	case_idle	;too right
     77  105b		       e6 21		      inc	$21
     78  105d		       4c 76 10 	      jmp	main_update_shift_end
     79  1060				   w_top
     80  1060							;check y <1
     81  1060		       a5 22		      lda	$22
     82  1062		       c9 01		      cmp	#1
     83  1064		       90 e1		      bcc	case_idle	;too top
     84  1066		       c6 22		      dec	$22
     85  1068		       4c 76 10 	      jmp	main_update_shift_end
     86  106b				   s_down
     87  106b							;check if y>21 => 21<y (22 is maximum)
     88  106b		       a9 15		      lda	#21
     89  106d		       c5 22		      cmp	$22
     90  106f		       90 d6		      bcc	case_idle	;too bottom
     91  1071		       e6 22		      inc	$22
     92  1073		       4c 76 10 	      jmp	main_update_shift_end
     93  1076				   main_update_shift_end
     94  1076		       20 8a 10 	      jsr	shift_on_monitor
     95  1079		       a0 00		      ldy	#$0
     96  107b		       a9 01		      lda	#01	;a squre
     97  107d		       91 02		      sta	($02),y
     98  107f		       a9 02		      lda	#02	;color red
     99  1081		       91 04		      sta	($04),y
    100  1083		       20 ec 10 	      jsr	interval_start
    101  1086		       4c 20 10 	      jmp	main_loop
    102  1089				   exit_prg
    103  1089		       60		      rts
    104  108a
    105  108a
    106  108a
    107  108a
    108  108a							;take take y@[22],x@[21],store to [01][00] as shift,
    109  108a							;[03][02] as character movment, [05][04]as screen color movment
    110  108a				   shift_on_monitor
    111  108a		       a5 21		      lda	$21
    112  108c		       85 03		      sta	$03	;->xto[3]
    113  108e		       a5 22		      lda	$22
    114  1090		       85 04		      sta	$04	; -> y to [4]
    115  1092		       a9 00		      lda	#$00
    116  1094		       85 01		      sta	$01
    117  1096		       85 00		      sta	$00
    118  1098				   som_loop
    119  1098				   som_y
    120  1098		       a5 04		      lda	$04
    121  109a		       c9 00		      cmp	#$0
    122  109c		       f0 12		      beq	som_x
    123  109e		       18		      clc
    124  109f		       a9 16		      lda	#22
    125  10a1		       65 00		      adc	$0
    126  10a3		       85 00		      sta	$0
    127  10a5
    128  10a5		       a5 01		      lda	$01
    129  10a7		       69 00		      adc	#$0
    130  10a9		       85 01		      sta	$01
    131  10ab
    132  10ab		       c6 04		      dec	$04
    133  10ad		       4c 98 10 	      jmp	som_y
    134  10b0				   som_x
    135  10b0		       18		      clc
    136  10b1		       a5 03		      lda	$03
    137  10b3		       65 00		      adc	$0
    138  10b5		       85 00		      sta	$0
    139  10b7		       a5 01		      lda	$01
    140  10b9		       69 00		      adc	#$0
    141  10bb		       85 01		      sta	$01
    142  10bd
    143  10bd							;calculate movement of characters
    144  10bd							;not out of border is assumend
    145  10bd							;last 2 digit always 0
    146  10bd		       a5 00		      lda	$00
    147  10bf		       85 02		      sta	$02
    148  10c1		       85 04		      sta	$04
    149  10c3		       18		      clc
    150  10c4
    151  10c4		       a9 1e		      lda	#$1e
    152  10c6		       65 01		      adc	$01
    153  10c8		       85 03		      sta	$03
    154  10ca
    155  10ca		       a9 96		      lda	#$96
    156  10cc		       65 01		      adc	$01
    157  10ce		       85 05		      sta	$05
    158  10d0		       60		      rts
    159  10d1
    160  10d1							;function:clear screen
    161  10d1				   clear_screen
    162  10d1		       a9 00		      lda	#0
    163  10d3		       a2 00		      ldx	#0
    164  10d5				   clear_char
    165  10d5		       9d 00 1e 	      STA	$1e00,X
    166  10d8		       9d 00 1f 	      STA	$1f00,X
    167  10db		       e8		      INX
    168  10dc		       d0 f7		      BNE	clear_char
    169  10de
    170  10de		       a9 01		      lda	#01
    171  10e0		       a2 00		      ldx	#0
    172  10e2				   white_color
    173  10e2		       9d 00 96 	      STA	$9600,X
    174  10e5		       9d ff 96 	      STA	$96ff,x
    175  10e8		       e8		      INX
    176  10e9		       d0 f7		      BNE	white_color
    177  10eb		       60		      rts
    178  10ec							;function:clear screen end
    179  10ec
    180  10ec							;loopoverdelay255
    181  10ec				   interval_start
    182  10ec		       a9 00		      lda	#$0
    183  10ee		       85 11		      sta	$11
    184  10f0				   interval_loop
    185  10f0		       a5 11		      lda	$11
    186  10f2		       c9 0a		      cmp	#$0a
    187  10f4		       f0 08		      beq	interval_done
    188  10f6		       e6 11		      inc	$11
    189  10f8		       20 ff 10 	      jsr	delay255_start
    190  10fb		       4c f0 10 	      jmp	interval_loop
    191  10fe				   interval_done
    192  10fe		       60		      rts
    193  10ff
    194  10ff							;delay loop
    195  10ff				   delay255_start
    196  10ff		       a9 00		      lda	#$0
    197  1101		       85 01		      sta	$01
    198  1103				   delay255_loop
    199  1103		       a5 01		      lda	$01
    200  1105		       c9 ff		      cmp	#$FF
    201  1107		       f0 05		      beq	delay255_done
    202  1109		       e6 01		      inc	$01
    203  110b		       4c 03 11 	      jmp	delay255_loop
    204  110e				   delay255_done
    205  110e		       60		      rts
    206  110f
    207  110f							;include "shift_on_monitor.s"
    208  110f							;include "tempChars.s"
    209  110f				   store_char
    210  110f		       a2 00		      ldx	#$0
    211  1111		       a9 00		      lda	#$0
    212  1113				   char1
    213  1113		       e0 08		      cpx	#8
    214  1115		       f0 07		      beq	char2
    215  1117		       9d 00 1c 	      sta	$1c00,x
    216  111a		       e8		      inx
    217  111b		       4c 13 11 	      jmp	char1
    218  111e				   char2
    219  111e		       a9 ff		      lda	#$ff
    220  1120		       e0 10		      cpx	#16
    221  1122		       f0 07		      beq	store_char_end
    222  1124		       9d 00 1c 	      sta	$1c00,x
    223  1127		       e8		      inx
    224  1128		       4c 1e 11 	      jmp	char2
    225  112b				   store_char_end
    226  112b		       60		      rts
